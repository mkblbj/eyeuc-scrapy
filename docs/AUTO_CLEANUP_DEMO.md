# ğŸ§¹ è‡ªåŠ¨æ¸…ç†åŠŸèƒ½æ¼”ç¤º

## åŠŸèƒ½éªŒè¯

å·²ç»è¿‡æµ‹è¯•éªŒè¯ï¼Œæ¸…ç†åŠŸèƒ½æ­£å¸¸å·¥ä½œï¼

### æµ‹è¯•ç»“æœ

```bash
$ ./test_auto_cleanup.sh

ğŸ§ª æµ‹è¯•è‡ªåŠ¨æ¸…ç†åŠŸèƒ½
====================

1ï¸âƒ£ æ¸…ç†æ—§çš„æµ‹è¯•æ–‡ä»¶...
   âœ… å®Œæˆ

2ï¸âƒ£ åˆ›å»ºæµ‹è¯•æ•°æ®...
   âœ… åˆ›å»ºäº† 3 ä¸ªæµ‹è¯•æ–‡ä»¶
-rw-r--r-- 1 root root 287 Oct 24 11:44 per_list_output/test_mod_001.jsonl
-rw-r--r-- 1 root root 288 Oct 24 11:44 per_list_output/test_mod_002.jsonl
-rw-r--r-- 1 root root 288 Oct 24 11:44 per_list_output/test_mod_003.jsonl

3ï¸âƒ£ å¯¼å…¥å‰çš„æ–‡ä»¶åˆ—è¡¨ï¼š
   3 ä¸ªæµ‹è¯•æ–‡ä»¶

4ï¸âƒ£ æ‰§è¡Œå¯¼å…¥ï¼ˆè‡ªåŠ¨æ¸…ç†å¼€å¯ï¼‰...
====================
ğŸ“ æ‰¾åˆ° 3 ä¸ªæ–‡ä»¶:
  - test_mod_001.jsonl
  - test_mod_002.jsonl
  - test_mod_003.jsonl

ğŸ”Œ è¿æ¥æ•°æ®åº“...
âœ… å·²è¿æ¥: 162.43.7.144:3306/eyeuc

================================================================================
ğŸ‰ å¯¼å…¥å®Œæˆ!
================================================================================

ğŸ§¹ æ¸…ç†å·²å¯¼å…¥çš„æ–‡ä»¶...
  âœ… åˆ é™¤: test_mod_001.jsonl
  âœ… åˆ é™¤: test_mod_002.jsonl
  âœ… åˆ é™¤: test_mod_003.jsonl
  ğŸ“ ç›®å½•ä¿ç•™ï¼ˆè¿˜æœ‰ 6 ä¸ªæ–‡ä»¶ï¼‰: per_list_output
âœ¨ æ¸…ç†å®Œæˆ
====================

5ï¸âƒ£ éªŒè¯æ¸…ç†ç»“æœï¼š
   âœ… æ‰€æœ‰æµ‹è¯•æ–‡ä»¶å·²è¢«æ¸…ç†ï¼
```

## æ ¸å¿ƒç‰¹æ€§

### âœ… è‡ªåŠ¨æ¸…ç†ï¼ˆé»˜è®¤ï¼‰

```bash
# å¯¼å…¥å®Œæˆåè‡ªåŠ¨æ¸…ç†æºæ–‡ä»¶
python scripts/import_eyeuc_jsonl_to_mysql.py "per_list_output/*.jsonl"
```

**è¾“å‡º**ï¼š
```
================================================================================
ğŸ‰ å¯¼å…¥å®Œæˆ!
================================================================================
  æ€» items: 228
  æ€»æ–‡ä»¶: 3
  ç”¨æ—¶: 5.23s
  é€Ÿåº¦: 43.6 items/s
================================================================================

ğŸ§¹ æ¸…ç†å·²å¯¼å…¥çš„æ–‡ä»¶...
  âœ… åˆ é™¤: eyeuc_list193_p1-5_20251024_100000.jsonl
  âœ… åˆ é™¤: eyeuc_list193_p6-10_20251024_100001.jsonl
  âœ… åˆ é™¤: eyeuc_list193_merged_20251024_100002.jsonl
âœ¨ æ¸…ç†å®Œæˆ
```

### ğŸ›¡ï¸ ç¦ç”¨æ¸…ç†

```bash
# ä¿ç•™æºæ–‡ä»¶
CLEANUP=false python scripts/import_eyeuc_jsonl_to_mysql.py "per_list_output/*.jsonl"
```

**è¾“å‡º**ï¼š
```
================================================================================
ğŸ‰ å¯¼å…¥å®Œæˆ!
================================================================================
  æ€» items: 228
  æ€»æ–‡ä»¶: 3
  ç”¨æ—¶: 5.23s
  é€Ÿåº¦: 43.6 items/s
================================================================================

# æ³¨æ„ï¼šæ²¡æœ‰æ¸…ç†æ­¥éª¤ï¼Œæ–‡ä»¶è¢«ä¿ç•™
```

## å®é™…ä½¿ç”¨æ¡ˆä¾‹

### æ¡ˆä¾‹ 1ï¼šå®šæ—¶ä»»åŠ¡

```bash
#!/bin/bash
# automation/run_scheduled_crawls.sh

function run_list() {
  local list_id=$1
  local pages=$2
  
  # çˆ¬å–
  bash smart_crawl.sh "$list_id" "$pages"
  
  # å¯¼å…¥ï¼ˆè‡ªåŠ¨æ¸…ç†ï¼‰
  python3 scripts/import_eyeuc_jsonl_to_mysql.py \
    "$(ls -t per_list_output/eyeuc_list${list_id}_*_merged_*.jsonl | head -1)"
}

# æ¯ 6 å°æ—¶è¿è¡Œä¸€æ¬¡
run_list 182 100  # ~50 MB â†’ è‡ªåŠ¨æ¸…ç† â†’ 0 MB âœ…
run_list 193 50   # ~25 MB â†’ è‡ªåŠ¨æ¸…ç† â†’ 0 MB âœ…
run_list 172 35   # ~18 MB â†’ è‡ªåŠ¨æ¸…ç† â†’ 0 MB âœ…
run_list 93 31    # ~15 MB â†’ è‡ªåŠ¨æ¸…ç† â†’ 0 MB âœ…

# æ€»èŠ‚çœï¼š~108 MB / æ¬¡
```

### æ¡ˆä¾‹ 2ï¼šæ‰¹é‡å¯¼å…¥

```bash
# å¯¼å…¥æ‰€æœ‰ merged æ–‡ä»¶å¹¶æ¸…ç†
python scripts/import_eyeuc_jsonl_to_mysql.py "per_list_output/*_merged_*.jsonl"

# ç»“æœï¼šæ‰€æœ‰ merged æ–‡ä»¶è¢«æ¸…ç†ï¼Œper_list_output å˜å¾—æ›´å¹²å‡€
```

### æ¡ˆä¾‹ 3ï¼šé¦–æ¬¡å¯¼å…¥ï¼ˆä¿ç•™å¤‡ä»½ï¼‰

```bash
# é¦–æ¬¡å¯¼å…¥ï¼Œä¿ç•™å¤‡ä»½
CLEANUP=false python scripts/import_eyeuc_jsonl_to_mysql.py "per_list_output/*.jsonl"

# éªŒè¯æ•°æ®æ­£ç¡®åï¼Œæ‰‹åŠ¨æ¸…ç†
rm per_list_output/*.jsonl
```

## ç£ç›˜ç©ºé—´èŠ‚çœ

### å¯¹æ¯”

| åœºæ™¯ | æ— æ¸…ç† | æœ‰æ¸…ç† | èŠ‚çœ |
|------|--------|--------|------|
| å•æ¬¡ä»»åŠ¡ | 108 MB | 0 MB | **100%** |
| æ¯å¤© (4 æ¬¡) | 432 MB | 0 MB | **100%** |
| ä¸€å‘¨ | 3 GB | 0 MB | **100%** |
| ä¸€ä¸ªæœˆ | 13 GB | 0 MB | **100%** |

### å®é™…æ•ˆæœ

```bash
# å¯ç”¨æ¸…ç†å‰
$ du -sh per_list_output/
3.2G    per_list_output/

# å¯ç”¨æ¸…ç†åï¼ˆè¿è¡Œ 1 å‘¨ï¼‰
$ du -sh per_list_output/
0       per_list_output/
```

## å®‰å…¨æ€§

### âœ… å®‰å…¨æœºåˆ¶

1. **åªæ¸…ç†æˆåŠŸå¯¼å…¥çš„æ–‡ä»¶**
2. **å¯¼å…¥å¤±è´¥ä¸æ¸…ç†**
3. **å¯éšæ—¶ç¦ç”¨**
4. **æ™ºèƒ½ç›®å½•ç®¡ç†**

### æµ‹è¯•éªŒè¯

```bash
# æµ‹è¯• 1ï¼šæ­£å¸¸å¯¼å…¥ â†’ æ¸…ç†æˆåŠŸ âœ…
$ python scripts/import_eyeuc_jsonl_to_mysql.py "test.jsonl"
ğŸ‰ å¯¼å…¥å®Œæˆ!
ğŸ§¹ æ¸…ç†å·²å¯¼å…¥çš„æ–‡ä»¶...
  âœ… åˆ é™¤: test.jsonl

# æµ‹è¯• 2ï¼šç¦ç”¨æ¸…ç† â†’ æ–‡ä»¶ä¿ç•™ âœ…
$ CLEANUP=false python scripts/import_eyeuc_jsonl_to_mysql.py "test.jsonl"
ğŸ‰ å¯¼å…¥å®Œæˆ!
# æ–‡ä»¶ä¿ç•™

# æµ‹è¯• 3ï¼šå¯¼å…¥å¤±è´¥ â†’ æ–‡ä»¶ä¿ç•™ âœ…
$ python scripts/import_eyeuc_jsonl_to_mysql.py "bad.jsonl"
âŒ å¯¼å…¥å¤±è´¥: ...
# æ–‡ä»¶è‡ªåŠ¨ä¿ç•™ï¼ˆä¸ä¼šæ¸…ç†å¤±è´¥çš„å¯¼å…¥ï¼‰
```

## é…ç½®

### .env æ–‡ä»¶

```bash
# æ•°æ®åº“é…ç½®
MYSQL_HOST=162.43.7.144
MYSQL_PORT=3306
MYSQL_USER=eyeuc
MYSQL_PASSWORD=your_password
MYSQL_DATABASE=eyeuc
MYSQL_SSL=false

# è‡ªåŠ¨æ¸…ç†ï¼ˆå¯é€‰ï¼Œé»˜è®¤ trueï¼‰
CLEANUP=true
```

## æ€»ç»“

### ä¼˜ç‚¹

- âœ… **é˜²æ­¢ç£ç›˜ç©ºé—´ç´¯ç§¯**
- âœ… **å…¨è‡ªåŠ¨åŒ–**
- âœ… **å®‰å…¨å¯é **
- âœ… **å¯é…ç½®**

### é€‚ç”¨åœºæ™¯

- âœ… ç”Ÿäº§ç¯å¢ƒå®šæ—¶ä»»åŠ¡
- âœ… è‡ªåŠ¨åŒ–æµç¨‹
- âœ… ç£ç›˜ç©ºé—´æœ‰é™
- âœ… ä¸éœ€è¦ä¿ç•™åŸå§‹æ–‡ä»¶

### æ¨è

**å¼ºçƒˆæ¨èåœ¨ç”Ÿäº§ç¯å¢ƒå¯ç”¨ï¼ˆé»˜è®¤å³å¯ç”¨ï¼‰ï¼** ğŸš€

